<div class="app">
    <header class="header">
        <div class="grid">
            <nav class="header__navbar">
                <ul class="header__navbar-list">
                    <li class="header__navbar-item">
                        <a href="/home" class="header__navbar-item-link">Trang chủ</a>
                    </li>
                </ul>
                <ul class="header__navbar-list">
                    <li class="header__navbar-item
                        header__navbar-item-has-notify">
                        <i class="fas fa-bell header__navbar-icon"></i>
                        <div onclick=viewNotify()
                            class="header__navbar-item-link">Thông báo</div>
                        <div class="header__notify">
                            <header class="header__notify-header">
                                <h3>Thông báo mới nhận</h3>
                            </header>
                            <ul class="header__notify-list"
                                id="header__notify-list">
                                
                            </ul>
                        </div>
                    </li>
                    <li class="header__navbar-item">
                        <a href="/user/login" class="header__navbar-item-link">Đăng nhập</a>
                    </li>
                    <li class="header__navbar-item" >
                            <i class="fas fa-user-circle"></i>
                            <div onclick=showUserInfo() class="header__navbar-item-link">Tài khoản</div>
                            <div class="header__userinfo" id="header__userinfo">
                                <div class="header__userinfo-logo">
                                    <i class="fas fa-user-circle header__userinfo-logo-icon"></i>
                                </div>

                            </div>
                        </li>
                        
                </ul>
                
            </nav>
            <div class="header-with-search">
                <img src="/img/logo.png" onclick="location.href='/home'" alt="" class="header-logo">
                <div class="header__search">
                    <form class="header__search-form" action="/search">
                        <input name="keyword" type="text"
                            class="header__search-input"
                            placeholder="Nhap ten phim">
                        <button type="submit"
                            class="header__search-btn">
                            <i class="fas fa-search
                                header__search-btn-icon"></i>
                        </button>
                    </form>
                </div>
            <div class="header_menu_icon" style="display: flex;">
                <label for="nav-mobile-search" class="header__navbar__btn">
                    <i class="fas fa-search"></i>
                </label>
                <label for="nav-mobile-input" class="header__navbar__btn">
                    <i class="fas fa-bars"></i>
                </label>
            </div>
            <input type="checkbox" hidden class="nav_input" id="nav-mobile-input">
            <input type="checkbox" hidden class="nav_input" id="nav-mobile-search">
            <label for="nav-mobile-input" class="nav__overlay"></label>
            <nav class="header__navbar__mobile" >
                <div class="header__navbar__mobile-header">
                    <img src="/img/logo.png" onclick="location.href='/home'" alt="" class="header-menu-logo">
                    <label for="nav-mobile-input" class="header-menu-mobile-exit">
                        <i class="fas fa-times"></i>
                    </label>
                </div>
                <ul class="header__navbar-list__mobile" >
                    <li class="header__navbar-item__mobile" >
                        <a href="/home" class="header__navbar-item-link__mobile" >
                        <i class="fas fa-home header__navbar-icon__mobile"></i>Trang chủ</a>
                    </li>
                    <li class="header__navbar-item__mobile" >
                        <a href="/user/login" class="header__navbar-item-link__mobile" >
                        <i class="fas fa-sign-in-alt header__navbar-icon__mobile"></i>Đăng nhập</a>
                    </li>
                    <input type="checkbox" hidden id="showaccount">
                    <label for="showaccount" class="header__navbar-item__mobile header__navbar-account" >
                            
                            <div class="header__navbar-item-link__mobile" >
                                <i class="fas fa-user-circle header__navbar-icon__mobile"></i>
                                Tài khoản</div>
                    </label>
                    <li class="header__navbar-userinfo__mobile" id="header__userinfo-mobile">
                        {{!-- <div class="header__userinfo__mobile" >
                            <img class="header__userinfo-logo__mobile" src="https://www.adobe.com/content/dam/cc/us/en/creativecloud/design/discover/mascot-logo-design/mascot-logo-design_fb-img_1200x800.jpg"/>
                            <div class="header__userinfo__mobile-box">
                                <div class="header__userinfo__mobile-name">Bui Truong Giang</div>
                                <div class="header__userinfo__mobile-username">Tgiang</div>
                            </div>
                        </div>
                        <form action="">
                            <button type="submit" class="menubutton-mobile">
                            Quản lí tài khoản
                            </button>
                        </form> --}}
                    </li> 
                    <input type="checkbox" hidden id="shownotify">
                     <label for="shownotify" class="header__navbar-item__mobile" >                        
                        <div
                            class="header__navbar-item-link__mobile" >
                            <i class="fas fa-bell header__navbar-icon__mobile" ></i>Thông báo</div>
                     </label>
                    <div class="header__notify__mobile" >
                            <header class="header__notify-header__mobile" >
                                <h3>Thông báo mới nhận</h3>
                            </header>
                            <ul class="header__notify-list__mobile" id="header__notify-list-mobile">
                                {{!-- <li class="header__notify-item-mobile">
                                <div class="header__notify-link-mobile">
                                    <img src="/appdata/filmposters/123.jpg" class="header__notify-img-mobile">
                                    <div class="header__notify-info-mobile">
                                        Phim cập nhật hoàn tất
                                    </div>
                                    </div>
                                </li> --}}
                            </ul>
                    </div>   
                </ul>
                
            </nav>                               
            
            <div class="header-search-mobile-container">
                <div class="header__search-mobile">
                    <form class="header__search-form-mobile" action="/search">
                        <input name="keyword" type="text"
                            class="header__search-input-mobile"
                            placeholder="Nhap ten phim">
                        <button type="submit"
                            class="header__search-btn-mobile">
                            <i class="fas fa-search
                                header__search-btn-icon-mobile"></i>
                        </button>
                    </form>
                </div>  
            </div> 
            </div>
                     
        </div>
        
    </header>
    <div class="container">
        <div class="grid">
            <div class="grid__row">
                <div class="grid__column-9" style="margin-top:40px">
                        <div class="manage_film">
                            <h1 class="manage_film_header">Quản lý phim</h1>
                            <div class="manage_film_menu">
                                
                                    <a href="/user/uploadfilm"class="admin_button_link" >
                                        <div class="admin_button">
                                            Tải phim lên
                                        </div>
                                    </a>
                               
                                
                                    <a href="/user/managefilm"class="admin_button_link" >
                                        <div class="admin_button">
                                            Xem danh sách phim
                                        </div>
                                    </a>
                               
                                </div>
                            <div class="manage__film-search">
                                <input id="manage_film_keyword" type="text" class="manage__film-search__input">
                                <button onclick=managefilmload() class="manage__film-search-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <ul id="manage_film-list" class="manage__film-list">
                                
                            </ul>
                            <ul class="pagination">
                                <li class="pagination-item">
                                    <a href="" class="pagination-item__link">
                                        <i class="pagination-item__icon fas fa-chevron-left"></i>
                                    </a>
                                </li>
                                <li class="pagination-item">
                                    <a href="/user/managefilm?page=1" class="pagination-item__link">1</a>
                                </li>
                                <li class="pagination-item">
                                    <a href="/user/managefilm?page=2" class="pagination-item__link">2</a>
                                </li>
                                <li class="pagination-item">
                                    <a href="/user/managefilm?page=3" class="pagination-item__link">3</a>
                                </li>
                                <li class="pagination-item">
                                    <a href="/user/managefilm?page=4" class="pagination-item__link">4</a>
                                </li>
                                <li class="pagination-item">
                                    <a href="" class="pagination-item__link">
                                        <i class="pagination-item__icon fas fa-chevron-right"></i>
                                    </a>
                                </li>
                            </ul>
                            <script>
                                function displayalert(id){
                                    var element =document.getElementById(id);
                                    if(element.style.display=="none") element.style.display="flex";
                                    else element.style.display="none"
                                }
                                function confirmdelete(id){
                                    fetch("/user/apis/deletefilm?slug="+id,
                                    {
                                        method:"DELETE"
                                    })
                                    .then(res=>{
                                        return res.json()
                                    }).then(data=>{
                                        console.log(data);
                                    })
                                    .catch(err=>{

                                    })
                                    location.reload();            
                                }
                                function canceldelete(id){
                                    displayalert(id)
                                    
                                }
                                function managefilmload(){
                                    var filmlist=document.getElementById("manage_film-list");
                                    var keyword="";
                                    filmlist.innerHTML="";
                                    if(document.getElementById("manage_film_keyword")) keyword=document.getElementById("manage_film_keyword").value;
                                    fetch("http://localhost:3000/apis/allfilms?page={{page}}&keyword="+keyword.trim())
                                    .then(res=>{
                                        return res.json();
                                    }).then(films=>{
                                        films.forEach(film=>{
                                            filmlist.innerHTML+=
                                        `<li class="manage__film-list-item">
                                    <div class="manage__film-item">
                                        <a href="/films/${film.slug}" class="manage__film-item__link">
                                            <img src="${film.poster_link}" alt="" class="manage__film-item__img">
                                            <div class="manage__film-item-info">
                                                <h4 class=manage__film-item-title>${film.movie_name_eng}</h4>
                                                <div class="manage__film-item-title manage__film-item-title-vie">${film.movie_name_vie}</div>
                                            </div>
                                        </a>
                                        <button onclick="window.location.href = '/user/updatefilm/${film.slug}'" class="manage__film-item-btn">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button onclick=displayalert("${film.slug}") class="manage__film-item-btn">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>                
                                    </div>
                                    <div id="${film.slug}" class="managa__film-item-alert">
                                        <h4>Bạn có muốn xóa phim này không?</h4>
                                        <button onclick=confirmdelete("${film.slug}") class="manage__film-alert-btn manage__film-alert-btn-confirm">
                                            <i class="fas fa-check-circle"></i>
                                        </button> 
                                        <button onclick=canceldelete("${film.slug}") class="manage__film-alert-btn manage__film-alert-btn-cancel">
                                            <i class="fas fa-times-circle"></i>
                                        </button> 
                                    </div>
                                </li>`
                                        })
                                    })
                                }
                                managefilmload()
                            </script>
                        </div>
                    </div>
                <div class="grid__column-3 most_view_list">
                    <nav class="category">
                        <h2 class="category__heading">
                            <i class="fas fa-list-ul
                                category__heading-icon"></i>
                            Top phim xem nhiều
                        </h2>
                        <ul class="category-list" id="most-views-list">
                            
                        </ul>
                        
                    </nav>
                </div>

            </div>
        </div>
    </div>
    <footer class="footer">
        <div class="grid">
            <div class="grid__row">
                <div class="grid__column-6 footer-contact">
                    <a href="" class="footer-link">
                        <i class="fab fa-facebook"></i> My facebook
                    </a>
                    <a href="" class="footer-link">
                        <i class="fas fa-envelope"></i>
                        abcxyz@sis.edu.vn
                    </a>
                </div>
            </div>
        </div>
    </footer>
</div>
